(()=>{"use strict";var __webpack_modules__={257:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(705),_uuid__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(234),_open_iframe_resizer_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(619);const defaults={baseUrl:"https://webtor.io",width:"800px",height:null,mode:"video",subtitles:[],poster:null,header:!0,title:null,imdbId:null,version:"0.2.19",lang:null,userlang:null,i18n:{},features:{},referer:window.location.href};function parsePath(e){const t=e.replace(/^\//,"").split("/"),r=t.pop();return{pwd:"/"+t.join("/"),file:r}}class Player{constructor(e){this.send=e}play(){this.send("play")}pause(){this.send("pause")}setPosition(e){this.send("setPosition",e)}open(e){this.send("open",parsePath(e))}}class WebtorGenerator{constructor(){(0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_1__.A)(this,"TORRENT_FETCHED","torrent fetched"),(0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_1__.A)(this,"TORRENT_ERROR","torrent error"),(0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_1__.A)(this,"INIT","init"),(0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_1__.A)(this,"PLAY_CLICKED","play_clicked"),(0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_1__.A)(this,"OPEN","open"),(0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_1__.A)(this,"INJECT","inject"),(0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_1__.A)(this,"INITED","inited"),(0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_1__.A)(this,"PLAYER_STATUS","player status"),(0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_1__.A)(this,"CURRENT_TIME","current time"),(0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_1__.A)(this,"DURATION","duration"),(0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_1__.A)(this,"OPEN_SUBTITLES","open subtitles")}push(data){const id=(0,_uuid__WEBPACK_IMPORTED_MODULE_2__.A)(),elId=`webtor-${id}`;let dd=Object.assign({},defaults,data);dd.path&&(dd=Object.assign({},dd,parsePath(dd.path)));let el=null;if(dd.el)el=dd.el;else if(el=document.getElementById(dd.id),!el)throw`Failed to find element with id "${dd.id}"`;if(dd.torrentUrl&&dd.magnet)throw"There should be only one magnet or torrentUrl";if(!dd.torrentUrl&&!dd.magnet)throw"magnet or torrentUrl required";const params={id,mode:dd.mode},paramString=new URLSearchParams(params),url=`${dd.baseUrl}/show?${paramString.toString()}`,iframe=document.createElement("iframe");let unsubscribe;iframe.id=elId,dd.width&&(iframe.width=dd.width),dd.height&&(iframe.height=dd.height),iframe.setAttribute("allowFullScreen",""),iframe.setAttribute("webkitAllowFullScreen",""),iframe.setAttribute("mozAllowFullScreen",""),iframe.scrolling="no",iframe.frameBorder="0",dd.height||(iframe.onload=()=>{unsubscribe=(0,_open_iframe_resizer_core__WEBPACK_IMPORTED_MODULE_0__.n_)({},`#${elId}`)[0].unsubscribe}),iframe.allow="accelerometer; autoplay; encrypted-media; gyroscope; fullscreen; picture-in-picture",el.appendChild(iframe),iframe.src=url;const self=this,player=new Player(((e,t)=>{iframe.contentWindow.postMessage({id,name:e,data:t},"*")}));window.addEventListener("message",(function(event){const d=event.data;"object"==typeof d&&d.id==id&&(d.player=player,d.name==self.INIT?iframe.contentWindow.postMessage({id,name:"init",data:JSON.parse(JSON.stringify(dd))},"*"):d.name==self.PLAY_CLICKED?void 0!==unsubscribe&&unsubscribe():d.name==self.INJECT?eval(d.data):"function"==typeof data.on&&dd.on(d))}))}}function __WEBPACK_DEFAULT_EXPORT__(e){if(e){if(Array.isArray(e)){const t=new WebtorGenerator;for(const r of e)t.push(r);return t}return e}return new WebtorGenerator}},234:(e,t,r)=>{function n(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))}r.d(t,{A:()=>n})},705:(e,t,r)=>{function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function i(e,t,r){return(t=function(e){var t=function(e){if("object"!=n(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==n(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}r.d(t,{A:()=>i})},619:(e,t,r)=>{r.d(t,{n_:()=>m});const n=()=>typeof window<"u",i=e=>e instanceof HTMLIFrameElement,o=e=>{try{const t=new URL(e.src).origin;if("about:blank"!==t)return t}catch{}return null},a=e=>(Object.keys(e).forEach((t=>void 0===e[t]&&delete e[t])),e),_=e=>{const{height:t,width:r}=e.getBoundingClientRect();return{height:Math.ceil(t),width:Math.ceil(r)}},s=(e,t)=>e?t?e.querySelector(t):e.documentElement:null,d=(e,t)=>{e&&(t.bodyPadding&&(e.body.style.padding=t.bodyPadding),t.bodyMargin&&(e.body.style.margin=t.bodyMargin))},l=e=>e<=100?100:e<=120?1e3:1e4,u=function(){let e=null;return()=>{if(!e){const t=({target:e})=>{const t=c.find((({iframe:t})=>t.contentDocument===e.ownerDocument));if(!t)return;const{iframe:r,settings:n}=t,i=s(r.contentDocument,n.targetElementSelector);if(!i)return;const{height:o}=_(i);o&&f({newHeight:o,registeredElement:t})};e=new ResizeObserver((e=>e.forEach(t)))}return e}}();let c=[];const m=(e,t)=>{if(!n())return[];const r={offsetSize:0,checkOrigin:!0,enableLegacyLibSupport:!1,...a(e??{})},_=function(e){return"string"==typeof e?Array.from(document.querySelectorAll(e)).filter(i):e?i(e)?[e]:[]:Array.from(document.getElementsByTagName("iframe"))}(t),m=function(e,t){if(Array.isArray(e.checkOrigin))return e.checkOrigin;if(!e.checkOrigin)return[];const r=[];for(const e of t){const t=o(e);t&&r.push(t)}return r}(r,_);return _.map((e=>{const t={iframe:e,settings:r,interactionState:{isHovered:!1},initContext:{isInitialized:!1,retryAttempts:0}},n=function(e,t){const r=(e=>{try{return new URL(e.src).origin===window.location.origin}catch{return!1}})(e.iframe)?function(e){const{iframe:t,settings:r}=e,{targetElementSelector:n}=r;let i=0;const o=()=>{const e=s(t.contentDocument,n);if(!t.contentDocument||!e)return i++,setTimeout(o,l(i));d(t.contentDocument,r),u().observe(e)};return((e,t)=>{var r,n;const i="complete"===(null==(r=e.contentWindow)?void 0:r.document.readyState);"about:blank"!==e.src&&"about:blank"!==(null==(n=e.contentWindow)?void 0:n.location.href)&&i?t():e.addEventListener("load",t)})(t,o),()=>{const e=s(t.contentDocument,n);e&&u().unobserve(e),t.removeEventListener("load",o)}}(e):function(e,t){const{iframe:r,initContext:n,settings:{checkOrigin:i,enableLegacyLibSupport:o,targetElementSelector:a,bodyPadding:_,bodyMargin:s}}=e,d=n=>{var a;const _=!i||t.includes(n.origin);if(r.contentWindow===n.source&&_){if("iframe-resized"===(null==(a=n.data)?void 0:a.type)){const{height:t}=n.data;return void(t&&f({newHeight:t,registeredElement:e}))}if(o){const t=function(e){if("string"==typeof e.data&&e.data.startsWith("[iFrameSizer]")){const[t,r]=e.data.split(":"),n=+r;return n>0?n:null}return null}(n);return void(null!==t&&f({newHeight:t,registeredElement:e}))}}};window.addEventListener("message",d);const u=o?"[iFrameSizer]ID:0:false:false:32:true:true::auto:::0:false:child:auto:true:::true:::false":{type:"iframe-child-init",targetElementSelector:a,bodyPadding:_,bodyMargin:s},c=()=>{((e,t)=>{t(),e.addEventListener("load",t)})(r,(()=>{var e;return null==(e=r.contentWindow)?void 0:e.postMessage(u,"*")})),n.retryAttempts++,n.retryTimeoutId=window.setTimeout(c,l(n.retryAttempts))};return c(),()=>window.removeEventListener("message",d)}(e,t),n=function({iframe:e,interactionState:t}){const r=()=>{t.isHovered=!0},n=()=>{t.isHovered=!1};return e.addEventListener("mouseenter",r),e.addEventListener("mouseleave",n),()=>{e.removeEventListener("mouseenter",r),e.removeEventListener("mouseleave",n)}}(e);return()=>{r(),n()}}(t,m);return c.push(t),{unsubscribe:()=>{n(),c=c.filter((t=>t.iframe!==e))}}}))};function f({registeredElement:e,newHeight:t}){const{iframe:r,settings:n,interactionState:i,initContext:o}=e;o.isInitialized||(o.isInitialized=!0,clearTimeout(o.retryTimeoutId));const a=r.getBoundingClientRect(),_=t+n.offsetSize;if(r.style.height=`${_}px`,!n.onIframeResize)return;const s={iframe:r,settings:{...n},interactionState:{...i},previousRenderState:{rect:a},nextRenderState:{rect:r.getBoundingClientRect()}};n.onIframeResize(s)}const b=function(){let e=null;return()=>(e||(e=new ResizeObserver((e=>{if(!e[0].target)return;const{height:t,width:r}=_(e[0].target),n={type:"iframe-resized",width:r,height:t};window.parent.postMessage(n,"*")}))),e)}();let p=!1;function g(e,t=0){const{targetElementSelector:r,bodyPadding:n,bodyMargin:i}=e.data,o=s(document,r);if(p||window.parent!==e.source)return;if(!o)return setTimeout((()=>g(e,t+1)),l(t));d(document,{bodyMargin:i,bodyPadding:n});const a=b();a.disconnect(),a.observe(o),p=!0}!n()||window.self===window.top||window.addEventListener("message",(e=>{var t;"iframe-child-init"===(null==(t=e.data)?void 0:t.type)&&(e=>{"complete"===window.document.readyState?e():window.addEventListener("load",e)})((()=>g(e)))}))}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var r=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](r,r.exports,__webpack_require__),r.exports}__webpack_require__.d=(e,t)=>{for(var r in t)__webpack_require__.o(t,r)&&!__webpack_require__.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var __webpack_exports__={},_webtor_WebtorGenerator__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(257);function clean(e){for(var t in e)null!==e[t]&&void 0!==e[t]||delete e[t];return e}function makeEmbeds(e,t={}){for(const r of e){let e=r.getAttribute("src");e||(e=r.getAttribute("href"));let n=null,i=null;e&&e.match("^magnet:.*")&&(n=e),(e&&e.match(".torrent$")||e&&"application/x-bittorrent"==r.getAttribute("type"))&&(i=e),r.getAttribute("data-torrent")&&(i=r.getAttribute("data-torrent"));const o=r.parentNode,a=r.getAttribute("width"),_=r.getAttribute("height"),s=r.getAttribute("poster"),d=""==r.getAttribute("controls")||"true"==r.getAttribute("controls"),l={};for(const e of r.attributes)if("data-config"!=e.name&&e.name.startsWith("data-")){let t=e.value;try{t=JSON.parse(e.value)}catch(e){console.log(e)}l[e.name.replace("data-","")]=t}const u=[];for(const e of r.querySelectorAll("track"))u.push(clean({srclang:e.getAttribute("srclang"),label:e.getAttribute("label"),default:e.getAttribute("default"),src:e.getAttribute("src")}));u.length>0&&(l.subtitles=u);let c=r.getAttribute("data-config");c=null==c?{}:JSON.parse(c);const m=document.createElement("div");r.getAttribute("class")&&m.setAttribute("class",r.getAttribute("class")),r.getAttribute("id")&&m.setAttribute("id",r.getAttribute("id"));let f={el:m,magnet:n,torrentUrl:i,width:a,height:_,poster:s,controls:d};f=Object.assign({},t,clean(f),l,c),o.replaceChild(m,r),window.webtor.push(clean(f))}}window.webtor=(0,_webtor_WebtorGenerator__WEBPACK_IMPORTED_MODULE_0__.A)(window.webtor),makeEmbeds(document.querySelectorAll("video")),makeEmbeds(document.querySelectorAll("a[download]"),{mode:"download",width:"400px"})})();